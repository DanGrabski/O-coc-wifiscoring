// //ORGS
// app.get('/api/orgs/:abbr', db, routes.orgs.getOrg)
// app.get('/api/orgs', db, routes.orgs.getOrgs)
// app.post('/api/orgs', db, routes.orgs.postOrgs)
// app.put('/api/orgs/:abbr', db, routes.orgs.updateOrg)
// app.delete('/api/orgs/:abbr', db, routes.orgs.delOrg)
//
// exports.Org = new Schema({
//   name: String,
//   abbr: String,
//   runners: [{type: Schema.Types.ObjectId, ref: 'Runner'}]
// });

exports.getOrg = function(req, res, next) {
  console.log(req.path);
  var select = {abbr:req.params.abbr}

  req.db.Org.findOne(select, function(err, org) {
    if (err) return next(err);
    if (org) {
      console.log(org.abbr, org.name);
      res.status(200).json(org);
    } else {
      res.status(404).send('Not Found')
    }
  });
}

exports.getOrgs = function(req, res, next) {
  console.log(req.path);
  var select = {}

  req.db.Org.find( function(err, orgs) {
    if (err) return next(err);
    if (orgs) {
      res.status(200).json(orgs);
    } else {
      res.status(418).send("I'm a teapot! (Not Found)")
    }
  });
}

exports.postOrgs = function(req, res, next) {
  console.log(req.path);

  if (req.body.orgs) {
    for (i=0; i<req.body.orgs.length; i++) {
      //grab the org info
      neworg = req.body.orgs[i];
      //figure out if it already exists???? async call is messing up the loop.
  //     req.db.Org.findOne({abbr: neworg.abbr}).lean().exec(function(err, result) {
  //     })
  //     console.log(result)
  //     //save it or skip it
  //     console.log('loop: ', i)
  //     // console.log(foo)
  //     if (foo) {
  //       console.log('if foo')
  //       res.status(400)
  //     } else {
  //       console.log('not foo')
  //       console.log(neworg);
  //       o = req.db.Org(neworg)
  //       console.log("save this: ", o)
  //     }
  //   } // for body.orgs
  //   res.status(200)
  // } //if body.orgs
  // res.status(400).send('Bad Request')
}



exports.updateOrg = function(req, res, next) {
  console.log(req.path);
  console.log(req.body);
  res.send(req.body)
}

exports.delOrg = function(req, res, next) {
  console.log(req.path);
  console.log(req.body);
  res.send(req.body)
}

// I'm not sure what's going on here..
// This is the last line
